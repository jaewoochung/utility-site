{"ast":null,"code":"var util = require('util');\n\nvar Stream = require('stream');\n\nvar StringDecoder = require('string_decoder').StringDecoder;\n\nmodule.exports = StringStream;\nmodule.exports.AlignedStringDecoder = AlignedStringDecoder;\n\nfunction StringStream(from, to) {\n  if (!(this instanceof StringStream)) return new StringStream(from, to);\n  Stream.call(this);\n  if (from == null) from = 'utf8';\n  this.readable = this.writable = true;\n  this.paused = false;\n  this.toEncoding = to == null ? from : to;\n  this.fromEncoding = to == null ? '' : from;\n  this.decoder = new AlignedStringDecoder(this.toEncoding);\n}\n\nutil.inherits(StringStream, Stream);\n\nStringStream.prototype.write = function (data) {\n  if (!this.writable) {\n    var err = new Error('stream not writable');\n    err.code = 'EPIPE';\n    this.emit('error', err);\n    return false;\n  }\n\n  if (this.fromEncoding) {\n    if (Buffer.isBuffer(data) || typeof data === 'number') data = data.toString();\n    data = new Buffer(data, this.fromEncoding);\n  }\n\n  var string = this.decoder.write(data);\n  if (string.length) this.emit('data', string);\n  return !this.paused;\n};\n\nStringStream.prototype.flush = function () {\n  if (this.decoder.flush) {\n    var string = this.decoder.flush();\n    if (string.length) this.emit('data', string);\n  }\n};\n\nStringStream.prototype.end = function () {\n  if (!this.writable && !this.readable) return;\n  this.flush();\n  this.emit('end');\n  this.writable = this.readable = false;\n  this.destroy();\n};\n\nStringStream.prototype.destroy = function () {\n  this.decoder = null;\n  this.writable = this.readable = false;\n  this.emit('close');\n};\n\nStringStream.prototype.pause = function () {\n  this.paused = true;\n};\n\nStringStream.prototype.resume = function () {\n  if (this.paused) this.emit('drain');\n  this.paused = false;\n};\n\nfunction AlignedStringDecoder(encoding) {\n  StringDecoder.call(this, encoding);\n\n  switch (this.encoding) {\n    case 'base64':\n      this.write = alignedWrite;\n      this.alignedBuffer = new Buffer(3);\n      this.alignedBytes = 0;\n      break;\n  }\n}\n\nutil.inherits(AlignedStringDecoder, StringDecoder);\n\nAlignedStringDecoder.prototype.flush = function () {\n  if (!this.alignedBuffer || !this.alignedBytes) return '';\n  var leftover = this.alignedBuffer.toString(this.encoding, 0, this.alignedBytes);\n  this.alignedBytes = 0;\n  return leftover;\n};\n\nfunction alignedWrite(buffer) {\n  var rem = (this.alignedBytes + buffer.length) % this.alignedBuffer.length;\n  if (!rem && !this.alignedBytes) return buffer.toString(this.encoding);\n  var returnBuffer = new Buffer(this.alignedBytes + buffer.length - rem);\n  this.alignedBuffer.copy(returnBuffer, 0, 0, this.alignedBytes);\n  buffer.copy(returnBuffer, this.alignedBytes, 0, buffer.length - rem);\n  buffer.copy(this.alignedBuffer, 0, buffer.length - rem, buffer.length);\n  this.alignedBytes = rem;\n  return returnBuffer.toString(this.encoding);\n}","map":{"version":3,"sources":["/Users/jaewoochung/Documents/github_repositories/dashboard/node_modules/stringstream/stringstream.js"],"names":["util","require","Stream","StringDecoder","module","exports","StringStream","AlignedStringDecoder","from","to","call","readable","writable","paused","toEncoding","fromEncoding","decoder","inherits","prototype","write","data","err","Error","code","emit","Buffer","isBuffer","toString","string","length","flush","end","destroy","pause","resume","encoding","alignedWrite","alignedBuffer","alignedBytes","leftover","buffer","rem","returnBuffer","copy"],"mappings":"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","sourcesContent":["var util = require('util')\nvar Stream = require('stream')\nvar StringDecoder = require('string_decoder').StringDecoder\n\nmodule.exports = StringStream\nmodule.exports.AlignedStringDecoder = AlignedStringDecoder\n\nfunction StringStream(from, to) {\n  if (!(this instanceof StringStream)) return new StringStream(from, to)\n\n  Stream.call(this)\n\n  if (from == null) from = 'utf8'\n\n  this.readable = this.writable = true\n  this.paused = false\n  this.toEncoding = (to == null ? from : to)\n  this.fromEncoding = (to == null ? '' : from)\n  this.decoder = new AlignedStringDecoder(this.toEncoding)\n}\nutil.inherits(StringStream, Stream)\n\nStringStream.prototype.write = function(data) {\n  if (!this.writable) {\n    var err = new Error('stream not writable')\n    err.code = 'EPIPE'\n    this.emit('error', err)\n    return false\n  }\n  if (this.fromEncoding) {\n    if (Buffer.isBuffer(data) || typeof data === 'number') data = data.toString()\n    data = new Buffer(data, this.fromEncoding)\n  }\n  var string = this.decoder.write(data)\n  if (string.length) this.emit('data', string)\n  return !this.paused\n}\n\nStringStream.prototype.flush = function() {\n  if (this.decoder.flush) {\n    var string = this.decoder.flush()\n    if (string.length) this.emit('data', string)\n  }\n}\n\nStringStream.prototype.end = function() {\n  if (!this.writable && !this.readable) return\n  this.flush()\n  this.emit('end')\n  this.writable = this.readable = false\n  this.destroy()\n}\n\nStringStream.prototype.destroy = function() {\n  this.decoder = null\n  this.writable = this.readable = false\n  this.emit('close')\n}\n\nStringStream.prototype.pause = function() {\n  this.paused = true\n}\n\nStringStream.prototype.resume = function () {\n  if (this.paused) this.emit('drain')\n  this.paused = false\n}\n\nfunction AlignedStringDecoder(encoding) {\n  StringDecoder.call(this, encoding)\n\n  switch (this.encoding) {\n    case 'base64':\n      this.write = alignedWrite\n      this.alignedBuffer = new Buffer(3)\n      this.alignedBytes = 0\n      break\n  }\n}\nutil.inherits(AlignedStringDecoder, StringDecoder)\n\nAlignedStringDecoder.prototype.flush = function() {\n  if (!this.alignedBuffer || !this.alignedBytes) return ''\n  var leftover = this.alignedBuffer.toString(this.encoding, 0, this.alignedBytes)\n  this.alignedBytes = 0\n  return leftover\n}\n\nfunction alignedWrite(buffer) {\n  var rem = (this.alignedBytes + buffer.length) % this.alignedBuffer.length\n  if (!rem && !this.alignedBytes) return buffer.toString(this.encoding)\n\n  var returnBuffer = new Buffer(this.alignedBytes + buffer.length - rem)\n\n  this.alignedBuffer.copy(returnBuffer, 0, 0, this.alignedBytes)\n  buffer.copy(returnBuffer, this.alignedBytes, 0, buffer.length - rem)\n\n  buffer.copy(this.alignedBuffer, 0, buffer.length - rem, buffer.length)\n  this.alignedBytes = rem\n\n  return returnBuffer.toString(this.encoding)\n}\n"]},"metadata":{},"sourceType":"script"}